<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vacation requests :: Automatiko</title>
    <link rel="canonical" href="https://docs.automatiko.io/main/0.3.0/examples/vacations.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R2G3H6TJRK"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','G-R2G3H6TJRK')</script>
    <link rel="icon" href="../../../_/img/automatiko-logo-circle.png" type="image/png">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.automatiko.io"><img src="../../../_/img/automatiko-logo-circle.png" width="52px"/>Automatiko</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/automatiko-io">Souce code</a>
            <a class="navbar-item" href="https://github.com/automatiko-io/automatiko-engine/issues">Issues</a>
            <a class="navbar-item" href="https://github.com/automatiko-io/automatiko-engine/blob/master/CONTRIBUTING.md">Contribution</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="main" data-version="0.1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../about.html">Automatiko Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../about.html">About</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../concepts.html">Concepts</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../use-cases.html">Use cases</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../examples.html">Examples</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting-started.html">Getting started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../best-practice.html">Best practice</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Components</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/security.html">Security</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/messaging.html">Messaging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/persistence.html">Persistence</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/errors.html">Error handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/management.html">Process management</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../configuration.html">Configuration reference</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../faq.html">FAQ</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Automatiko Documentation</span>
    <span class="version">0.1.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Automatiko Documentation</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../0.3.0/about.html">0.3.0</a>
        </li>
        <li class="version">
          <a href="../../0.2.0/about.html">0.2.0</a>
        </li>
        <li class="version is-current">
          <a href="../about.html">0.1.0</a>
        </li>
        <li class="version">
          <a href="../../0.0.0/about.html">0.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../0.3.0/about.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../about.html">Automatiko Documentation</a></li>
    <li><a href="vacations.html">Vacation requests</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">0.1.0</button>
  <div class="version-menu">
    <a class="version" href="../../0.3.0/examples/vacations.html">0.3.0</a>
    <a class="version" href="../../0.2.0/examples/vacations.html">0.2.0</a>
    <a class="version is-current" href="vacations.html">0.1.0</a>
    <a class="version" href="../../0.0.0/examples/vacations.html">0.0.0</a>
  </div>
</div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Vacation requests</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Vacation requests example illustrates the human centric use case combined with
data base records use case. Vacation requests are placed by individual employees
and are automatically tracked as complete set of requests.
This enables clear visibility from employee point of view to see all his/her
requests regardless of their status. It also keeps track of how many days are used
and still eligible for further use.</p>
</div>
<div class="paragraph">
<p>At he same time, vacation requests require approval by manager and thus
a tasks are assigned to employee&#8217;s manager on each newly submitted vacation request.</p>
</div>
<div class="paragraph">
<p>Employee has an option to cancel request as long as the date when the vacation
should start has not been reached yet.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/examples-vacation.png" alt="examples vacation"></span></p>
</div>
<div class="paragraph">
<p>This service also allows to onboard new employees by assigning eligible vacation
days and a manager based on department employee is in.</p>
</div>
<div class="paragraph">
<p>As part of onboarding
following will take place directly:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>calculate eligible vacation days</p>
</li>
<li>
<p>assign manager</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Above data is derived from decision tables that look as follows</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Assign manager</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Manager</th>
<th class="tableblock halign-left valign-top">Department</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:john@email.com">john@email.com</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">finance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:mary@email.com">mary@email.com</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">it</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:joe@email.com">joe@email.com</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hr</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Vacation days eligibility</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Year of start</th>
<th class="tableblock halign-left valign-top">Number of days</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt; 2000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt; 2010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt; 2015</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt; 2015</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Note that this example is currently not equipped with user facing UI
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_run_it"><a class="anchor" href="#_run_it"></a>Run it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This example is self container for simplicity meaning it uses H2 data base
so there is no need for additional components to run this example.</p>
</div>
<div class="paragraph">
<p><code>docker run -p 8080:8080 automatiko/vacation-requests</code></p>
</div>
<div class="paragraph">
<p>once this is done you can see the fully described service at
 <a href="http://localhost:8080/swagger-ui/#/" class="bare">http://localhost:8080/swagger-ui/#/</a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can open your browser <a href="http://localhost:8080/management/processes/ui" class="bare">http://localhost:8080/management/processes/ui</a>
to visualize your running service
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are multiple paths that can be taken during given order</p>
</div>
<div class="paragraph">
<p>First top level (public) workflow defines the onboarding and overall tracking
for every employee - every instance is identified as employee&#8217;s email</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/vacations-workflow.png" alt="vacations workflow">
</div>
</div>
<div class="paragraph">
<p>Second workflow is responsible for managing individual requests for a given
employee, from the submission to either cancelation or its start date.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/vacation-request-workflow.png" alt="vacation request workflow">
</div>
</div>
<div class="sect2">
<h3 id="_authorization"><a class="anchor" href="#_authorization"></a>Authorization</h3>
<div class="paragraph">
<p>This service is fully secured and requires authentication to be able to interact
with it. Below table represents available users in the service</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Users available</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">User name</th>
<th class="tableblock halign-left valign-top">Password</th>
<th class="tableblock halign-left valign-top">Roles</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:john@email.com">john@email.com</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">john</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">employee</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:mary@email.com">mary@email.com</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">employee</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:mark@email.com">mark@email.com</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">employee</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:joe@email.com">joe@email.com</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">joe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">employee</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:admin@email.com">admin@email.com</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">admin</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is also instance level security that is based on <code>participants</code> access
policy. This means that given instance will be visible to the owner of it
(the employee) and the assignees of currently active user tasks - for example
manager who has at least one approval task awaiting.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Note that there is simple UI for manager to see incoming approval tasks.
Just open browser at <a href="http://localhost:8080" class="bare">http://localhost:8080</a> and connect using <code>john@email.com</code>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_the_happy_path"><a class="anchor" href="#_the_happy_path"></a>The happy path</h3>
<div class="paragraph">
<p>Happy path consists of steps that will onboard the employee and submit single
vacation request that is approved and is not cancelled by the employee.</p>
</div>
<div class="sect3">
<h4 id="_try_it"><a class="anchor" href="#_try_it"></a>Try it</h4>
<div class="paragraph">
<p>Follow steps in the <code>Details</code> section to see the happy path in action.</p>
</div>
<details>
<div class="content">
<div class="paragraph">
<p>Here are the steps to try out with happy path</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Onboard employee</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>POST</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations" class="bare">http://localhost:8080/vacations</a></code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "employee": {
    "email": "mary@email.com",
    "firstName": "Mary",
    "lastName": "Jane",
    "startedAt": "2000-12-01",
    "department": "finance"
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u mary@email.com:mary -X POST "http://localhost:8080/vacations" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"employee\":{\"email\":\"mary@email.com\",\"firstName\":\"Mary\",\"lastName\":\"Jane\",\"startedAt\":\"2020-12-26\",\"department\":\"finance\"}}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create new instance identified as <code>mary@email.com</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Submit a vacation request</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>POST</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com/submit" class="bare">http://localhost:8080/vacations/mary@email.com/submit</a></code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "from": "2020-10-01",
  "length": 15,
  "to": "2020-10-15",
  "key": "vacation"
}</pre>
</div>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u mary@email.com:mary -X POST "http://localhost:8080/vacations/mary%40email.com/submit" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"from\":\"2020-10-01\",\"length\":15,\"to\":\"2020-10-15\",\"key\":\"vacation\"}"</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Fetch approval tasks as manager</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>GET</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com/request/vacation/tasks" class="bare">http://localhost:8080/vacations/mary@email.com/request/vacation/tasks</a></code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u john@email.com:john -X GET "http://localhost:8080/vacations/mary%40email.com/requests/vacation/tasks" -H  "accept: application/json"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make note of the id returned from the above request as it will be used to complete
the approval task
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Approve vacation request</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>POST</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com/requests/vacation/approval/ID" class="bare">http://localhost:8080/vacations/mary@email.com/requests/vacation/approval/ID</a></code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "approved": true
}</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Replace the <code>{ID}</code> at the end of endpoint with ID from the previous call.
Same is required in the below curl command.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u john@email.com:john -X POST "http://localhost:8080/vacations/mary@email.com/requests/vacation/approval/ID" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"approved\":true}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now the workflow instance will wait until the first day of vacation request or
until it is cancelled by the employee.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Verify access policy restricting access to instances</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each employee has his/her instance completely secured. That means only that
employee can see it or manager - when it has approval task assigned. To verify
this working try to access mary&#8217;s instance by joe.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>GET</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com" class="bare">http://localhost:8080/vacations/mary@email.com</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u joe@email.com:joe -X GET "http://localhost:8080/vacations/mary%40email.com" -H  "accept: application/json"</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Clean the state</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is completely for test purpose to allow to use same data for other paths</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>DELETE</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com" class="bare">http://localhost:8080/vacations/mary@email.com</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u mary@email.com:mary -X DELETE "http://localhost:8080/vacations/mary%40email.com" -H  "accept: application/json"</code></pre>
</div>
</div>
</div>
</details>
</div>
</div>
<div class="sect2">
<h3 id="_the_rejection_path"><a class="anchor" href="#_the_rejection_path"></a>The rejection path</h3>
<div class="paragraph">
<p>Rejection path consists of steps that will onboard the employee and submit single
vacation request that is rejected by manager.</p>
</div>
<div class="sect3">
<h4 id="_try_it_2"><a class="anchor" href="#_try_it_2"></a>Try it</h4>
<div class="paragraph">
<p>Follow steps in the <code>Details</code> section to see the rejection path in action.</p>
</div>
<details>
<div class="content">
<div class="paragraph">
<p>Here are the steps to try out with happy path</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Onboard employee</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>POST</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations" class="bare">http://localhost:8080/vacations</a></code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "employee": {
    "email": "mary@email.com",
    "firstName": "Mary",
    "lastName": "Jane",
    "startedAt": "2000-12-01",
    "department": "finance"
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u mary@email.com:mary -X POST "http://localhost:8080/vacations" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"employee\":{\"email\":\"mary@email.com\",\"firstName\":\"Mary\",\"lastName\":\"Jane\",\"startedAt\":\"2020-12-26\",\"department\":\"finance\"}}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create new instance identified as <code>mary@email.com</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Submit a vacation request</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>POST</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com/submit" class="bare">http://localhost:8080/vacations/mary@email.com/submit</a></code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "from": "2020-10-01",
  "length": 15,
  "to": "2020-10-15",
  "key": "vacation"
}</pre>
</div>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u mary@email.com:mary -X POST "http://localhost:8080/vacations/mary%40email.com/submit" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"from\":\"2020-10-01\",\"length\":15,\"to\":\"2020-10-15\",\"key\":\"vacation\"}"</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Fetch approval tasks as manager</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>GET</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com/request/vacation/tasks" class="bare">http://localhost:8080/vacations/mary@email.com/request/vacation/tasks</a></code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u john@email.com:john -X GET "http://localhost:8080/vacations/mary%40email.com/requests/vacation/tasks" -H  "accept: application/json"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make note of the id returned from the above request as it will be used to complete
the approval task
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Approve vacation request</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>POST</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com/requests/vacation/approval/ID" class="bare">http://localhost:8080/vacations/mary@email.com/requests/vacation/approval/ID</a></code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "approved": false
}</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Replace the <code>{ID}</code> at the end of endpoint with ID from the previous call.
Same is required in the below curl command.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u john@email.com:john -X POST "http://localhost:8080/vacations/mary@email.com/requests/vacation/approval/ID" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"approved\":false}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point this request is completed and no longer available for any modification</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clean the state</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is completely for test purpose to allow to use same data for other paths</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>DELETE</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com" class="bare">http://localhost:8080/vacations/mary@email.com</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u mary@email.com:mary -X DELETE "http://localhost:8080/vacations/mary%40email.com" -H  "accept: application/json"</code></pre>
</div>
</div>
</div>
</details>
</div>
</div>
<div class="sect2">
<h3 id="_the_cancelled_request_path"><a class="anchor" href="#_the_cancelled_request_path"></a>The cancelled request path</h3>
<div class="paragraph">
<p>Cancelled request path consists of steps that will onboard the employee and submit single
vacation request that is approved by manager but later cancelled by employee.</p>
</div>
<div class="sect3">
<h4 id="_try_it_3"><a class="anchor" href="#_try_it_3"></a>Try it</h4>
<div class="paragraph">
<p>Follow steps in the <code>Details</code> section to see the cancelled request path in action.</p>
</div>
<details>
<div class="content">
<div class="paragraph">
<p>Here are the steps to try out with happy path</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Onboard employee</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>POST</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations" class="bare">http://localhost:8080/vacations</a></code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "employee": {
    "email": "mary@email.com",
    "firstName": "Mary",
    "lastName": "Jane",
    "startedAt": "2000-12-01",
    "department": "finance"
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u mary@email.com:mary -X POST "http://localhost:8080/vacations" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"employee\":{\"email\":\"mary@email.com\",\"firstName\":\"Mary\",\"lastName\":\"Jane\",\"startedAt\":\"2020-12-26\",\"department\":\"finance\"}}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create new instance identified as <code>mary@email.com</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Submit a vacation request</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>POST</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com/submit" class="bare">http://localhost:8080/vacations/mary@email.com/submit</a></code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "from": "2020-10-01",
  "length": 15,
  "to": "2020-10-15",
  "key": "vacation"
}</pre>
</div>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u mary@email.com:mary -X POST "http://localhost:8080/vacations/mary%40email.com/submit" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"from\":\"2020-10-01\",\"length\":15,\"to\":\"2020-10-15\",\"key\":\"vacation\"}"</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Fetch approval tasks as manager</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>GET</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com/request/vacation/tasks" class="bare">http://localhost:8080/vacations/mary@email.com/request/vacation/tasks</a></code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u john@email.com:john -X GET "http://localhost:8080/vacations/mary%40email.com/requests/vacation/tasks" -H  "accept: application/json"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make note of the id returned from the above request as it will be used to complete
the approval task
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Approve vacation request</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>POST</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com/requests/vacation/approval/ID" class="bare">http://localhost:8080/vacations/mary@email.com/requests/vacation/approval/ID</a></code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "approved": true
}</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Replace the <code>{ID}</code> at the end of endpoint with ID from the previous call.
Same is required in the below curl command.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u john@email.com:john -X POST "http://localhost:8080/vacations/mary@email.com/requests/vacation/approval/ID" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"approved\":false}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point this request is approved and waiting for the start of vacation.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fetch approval tasks as manager</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>GET</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com/request/vacation/tasks" class="bare">http://localhost:8080/vacations/mary@email.com/request/vacation/tasks</a></code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u mary@email.com:mary -X GET "http://localhost:8080/vacations/mary%40email.com/requests/vacation/tasks" -H  "accept: application/json"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make note of the id returned from the above request as it will be used to complete
the cancel task
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Cancel vacation request</p>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>POST</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com/requests/vacation/cancel/ID" class="bare">http://localhost:8080/vacations/mary@email.com/requests/vacation/cancel/ID</a></code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{}</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Replace the <code>{ID}</code> at the end of endpoint with ID from the previous call.
Same is required in the below curl command.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u mary@email.com:mary -X POST "http://localhost:8080/vacations/mary@email.com/requests/vacation/cancel/ID" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{}"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
After vacation request has been cancelled the used days are deducted with request&#8217;s length
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Clean the state</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is completely for test purpose to allow to use same data for other paths</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Http Method: <code>DELETE</code></p>
</li>
<li>
<p>Endpoint: <code><a href="http://localhost:8080/vacations/mary@email.com" class="bare">http://localhost:8080/vacations/mary@email.com</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>complete curl command for this request is as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">curl -u mary@email.com:mary -X DELETE "http://localhost:8080/vacations/mary%40email.com" -H  "accept: application/json"</code></pre>
</div>
</div>
</div>
</details>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_source_code"><a class="anchor" href="#_source_code"></a>Source code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Complete source code of this example can be found
<a href="https://github.com/automatiko-io/automatiko-examples/tree/main/vacation-requests">in GitHub</a></p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p class="text-center">© 2020 Automatiko. All rights reserved.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
