<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Water Leak detection :: Automatiko</title>
    <link rel="canonical" href="https://docs.automatiko.io/main/0.30.0/examples/leaks.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R2G3H6TJRK"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','G-R2G3H6TJRK')</script>
    <link rel="icon" href="../../../_/img/automatiko-logo-circle.png" type="image/png">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.automatiko.io"><img src="../../../_/img/automatiko-logo-circle.png" width="52px"/>Automatiko</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/automatiko-io">Souce code</a>
            <a class="navbar-item" href="https://github.com/automatiko-io/automatiko-engine/issues">Issues</a>
            <a class="navbar-item" href="https://github.com/automatiko-io/automatiko-engine/blob/master/CONTRIBUTING.md">Contribution</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="main" data-version="0.1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../about.html">Automatiko Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../about.html">About</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../concepts.html">Concepts</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../use-cases.html">Use cases</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../examples.html">Examples</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting-started.html">Getting started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../best-practice.html">Best practice</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Components</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/security.html">Security</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/messaging.html">Messaging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/persistence.html">Persistence</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/errors.html">Error handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/management.html">Process management</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../configuration.html">Configuration reference</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../faq.html">FAQ</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Automatiko Documentation</span>
    <span class="version">0.1.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Automatiko Documentation</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../0.30.0/about.html">0.30.0</a>
        </li>
        <li class="version">
          <a href="../../0.23.0/about.html">0.23.0</a>
        </li>
        <li class="version">
          <a href="../../0.22.0/about.html">0.22.0</a>
        </li>
        <li class="version">
          <a href="../../0.21.0/about.html">0.21.0</a>
        </li>
        <li class="version">
          <a href="../../0.20.0/about.html">0.20.0</a>
        </li>
        <li class="version">
          <a href="../../0.19.0/about.html">0.19.0</a>
        </li>
        <li class="version">
          <a href="../../0.18.0/about.html">0.18.0</a>
        </li>
        <li class="version">
          <a href="../../0.17.0/about.html">0.17.0</a>
        </li>
        <li class="version">
          <a href="../../0.16.0/about.html">0.16.0</a>
        </li>
        <li class="version">
          <a href="../../0.15.0/about.html">0.15.0</a>
        </li>
        <li class="version">
          <a href="../../0.14.0/about.html">0.14.0</a>
        </li>
        <li class="version">
          <a href="../../0.13.0/about.html">0.13.0</a>
        </li>
        <li class="version">
          <a href="../../0.12.0/about.html">0.12.0</a>
        </li>
        <li class="version">
          <a href="../../0.11.0/about.html">0.11.0</a>
        </li>
        <li class="version">
          <a href="../../0.10.0/about.html">0.10.0</a>
        </li>
        <li class="version">
          <a href="../../0.9.0/about.html">0.9.0</a>
        </li>
        <li class="version">
          <a href="../../0.8.0/about.html">0.8.0</a>
        </li>
        <li class="version">
          <a href="../../0.7.0/about.html">0.7.0</a>
        </li>
        <li class="version">
          <a href="../../0.6.0/about.html">0.6.0</a>
        </li>
        <li class="version">
          <a href="../../0.5.0/about.html">0.5.0</a>
        </li>
        <li class="version">
          <a href="../../0.4.0/about.html">0.4.0</a>
        </li>
        <li class="version">
          <a href="../../0.3.0/about.html">0.3.0</a>
        </li>
        <li class="version">
          <a href="../../0.2.0/about.html">0.2.0</a>
        </li>
        <li class="version is-current">
          <a href="../about.html">0.1.0</a>
        </li>
        <li class="version">
          <a href="../../0.0.0/about.html">0.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../0.30.0/about.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../about.html">Automatiko Documentation</a></li>
    <li><a href="leaks.html">Water Leak detection</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">0.1.0</button>
  <div class="version-menu">
    <a class="version" href="../../0.30.0/examples/leaks.html">0.30.0</a>
    <a class="version" href="../../0.23.0/examples/leaks.html">0.23.0</a>
    <a class="version" href="../../0.22.0/examples/leaks.html">0.22.0</a>
    <a class="version" href="../../0.21.0/examples/leaks.html">0.21.0</a>
    <a class="version" href="../../0.20.0/examples/leaks.html">0.20.0</a>
    <a class="version" href="../../0.19.0/examples/leaks.html">0.19.0</a>
    <a class="version" href="../../0.18.0/examples/leaks.html">0.18.0</a>
    <a class="version" href="../../0.17.0/examples/leaks.html">0.17.0</a>
    <a class="version" href="../../0.16.0/examples/leaks.html">0.16.0</a>
    <a class="version" href="../../0.15.0/examples/leaks.html">0.15.0</a>
    <a class="version" href="../../0.14.0/examples/leaks.html">0.14.0</a>
    <a class="version" href="../../0.13.0/examples/leaks.html">0.13.0</a>
    <a class="version" href="../../0.12.0/examples/leaks.html">0.12.0</a>
    <a class="version" href="../../0.11.0/examples/leaks.html">0.11.0</a>
    <a class="version" href="../../0.10.0/examples/leaks.html">0.10.0</a>
    <a class="version" href="../../0.9.0/examples/leaks.html">0.9.0</a>
    <a class="version" href="../../0.8.0/examples/leaks.html">0.8.0</a>
    <a class="version" href="../../0.7.0/examples/leaks.html">0.7.0</a>
    <a class="version" href="../../0.6.0/examples/leaks.html">0.6.0</a>
    <a class="version" href="../../0.5.0/examples/leaks.html">0.5.0</a>
    <a class="version" href="../../0.4.0/examples/leaks.html">0.4.0</a>
    <a class="version" href="../../0.3.0/examples/leaks.html">0.3.0</a>
    <a class="version" href="../../0.2.0/examples/leaks.html">0.2.0</a>
    <a class="version is-current" href="leaks.html">0.1.0</a>
    <a class="version" href="../../0.0.0/examples/leaks.html">0.0.0</a>
  </div>
</div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Water Leak detection</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Water leak detection example service demonstrates simple anomalies detection
such as water leaks based on collected sensor data.</p>
</div>
<div class="paragraph">
<p>Buildings are equipped with various sensors such as water meters, humidity
and more. In this example each room in the building will report its
water consumption on regular intervals - every 2 minutes. In addition to that
each room will also report humidity level, again on time intervals - every 10 minutes.</p>
</div>
<div class="paragraph">
<p>Based on this data, service will perform calculation of</p>
</div>
<div class="ulist">
<ul>
<li>
<p>min value</p>
</li>
<li>
<p>max value</p>
</li>
<li>
<p>average value</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Knowing these values anomalies can be detected by applying rules defined.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Humidity higher than 80% can be considered as anomaly or even potential water
leak</p>
</li>
<li>
<p>water consumption within 5 consequent measurements that is higher than 100
is considered leak.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In any of the above cases technicians would be called to investigate the
situation in the actual building.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/examples-leak.png" alt="examples leak"></span></p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Note that this example is currently not equipped with user facing UI
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_run_it"><a class="anchor" href="#_run_it"></a>Run it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The only thing that is needed is Apache Kafka running that will be accessible.
It needs to be given as part of run command via environment variable <code>KAFKA_SERVERS</code></p>
</div>
<div class="paragraph">
<p><code>docker run -e MQTT_SERVER= -e MQTT_PORT= -p 8080:8080 automatiko/event-streams-sensors</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To get quickly a running instance of Mosquitto to run the tests visit
<a href="https://hub.docker.com/_/eclipse-mosquitto">Docker Hub</a> for details
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>once this is done you can see the fully described service at
 <a href="http://localhost:8080/swagger-ui/#/" class="bare">http://localhost:8080/swagger-ui/#/</a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can open your browser <a href="http://localhost:8080/management/processes/ui" class="bare">http://localhost:8080/management/processes/ui</a>
to visualize your running service
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An important detail to mention is that MQTT allows to subscribe using wild cards.
This feature is used in this example as it allows flexible workflow definition.</p>
</div>
<div class="paragraph">
<p>Both start events (<code>Water measurement</code> and <code>Humidity measurement</code>) subscribe to
MQTT topics using wild cards</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>building/+/+/water</code> - this allows to receive any building&#8217;s and any room
of that building water consumption data</p>
</li>
<li>
<p><code>building/+/+/humidity</code> - this allows to receive any building&#8217;s and any room
of that building humidity data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In reality this means that every incoming sensor data to topic that matches this
MQTT wildcard will either start new instance of the workflow or push data into
already existing one.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>Humidity sensor in room 555 in building ABC will push data to <code>building/ABC/555/humidity</code>
topic and humidity sensor in the same building but room 123 will push data to
<code>building/ABC/555/humidity</code> topic.</p>
</div>
<div class="paragraph">
<p>This in turn will create two workflow (<code>waterleasks</code>)
instances that will be uniquely identified (so called business key)
<code>ABC-555</code> and <code>ABC-123</code> respectively.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This business key (<code>ABC-555</code>) can be used at any time to get hold of
given workflow instance with service API. It is also configurable when it
come to the format and content of the business key - in this example it
retrieves information from the actual topic data was sent to.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Similar water consumption data are handled. If they match the same building and
room the data will be "appended" to already existing workflow instance, otherwise
new instance will be started.</p>
</div>
<div class="paragraph">
<p>There are multiple paths that can be taken during detection process</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/water-leaks-workflow.png" alt="water leaks workflow">
</div>
</div>
<div class="paragraph">
<p>Each incoming sensor data will trigger either</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Water measurement</code> in case it comes from water meter</p>
</li>
<li>
<p><code>Humidity measurement</code> in case it comes from humidity sensor</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Water measurements are collected into a bucket that allows to accumulate
values and perform calculation on top of items.</p>
</div>
<div class="paragraph">
<p>Humidity data is constantly replacing previous value (if there was any),
so it always represents last known value.</p>
</div>
<div class="sect2">
<h3 id="_the_happy_path"><a class="anchor" href="#_the_happy_path"></a>The happy path</h3>
<div class="paragraph">
<p>The happy path for humidity means humidity level below 85%.
The happy path for water measurement means that there won&#8217;t be max value
greater than 100.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Water measurements are calculated every fifth value being received.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_try_it"><a class="anchor" href="#_try_it"></a>Try it</h4>
<div class="paragraph">
<p>Follow steps in the <code>Details</code> section to see the happy path in action.</p>
</div>
<details>
<div class="content">
<div class="paragraph">
<p>Here are the steps to try out with happy path</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Publish room 100 of building Main humidity data</p>
<div class="ulist">
<ul>
<li>
<p>Topic <code>building/Main/100/humidity</code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "ts" : 1608570416309,
  "val" : 48.0
}</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Publish room 100 of building Main water data</p>
<div class="ulist">
<ul>
<li>
<p>Topic <code>building/Main/100/water</code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "ts" : 1608570416309,
  "val" : 25.0
}</pre>
</div>
</div>
<div class="paragraph">
<p>Repeat water consumption data more than 5 times to see the report being
calculated. At any point in time you can use service API to see current
state of the active instances.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Why the format of the payload is as it is? The main reason is that it
follows <a href="https://github.com/mqtt-smarthome/mqtt-smarthome">MQTT SmartHome</a>
 specification to provide some degree of standardisation.
</td>
</tr>
</table>
</div>
</div>
</details>
</div>
</div>
<div class="sect2">
<h3 id="_the_leak_detected_path"><a class="anchor" href="#_the_leak_detected_path"></a>The leak detected path</h3>
<div class="paragraph">
<p>The leak detected path means water measurement won&#8217;t be at any time
greater than 100. This is based on report - calculated values of
at least 5 data points - measurements.</p>
</div>
<div class="paragraph">
<p>As soon as there will be a value exceeding 100 for water consumption level it will
 trigger a task assigned to technicians. That means that there is a need for
 investigation on site to confirm or deny detected anomaly.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Water measurements are calculated every fifth value being received.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_try_it_2"><a class="anchor" href="#_try_it_2"></a>Try it</h4>
<div class="paragraph">
<p>Follow steps in the <code>Details</code> section to see the leak detected path in action.</p>
</div>
<details>
<div class="content">
<div class="paragraph">
<p>Here are the steps to try out with leak detected path</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Publish room 100 of building Main water data</p>
<div class="ulist">
<ul>
<li>
<p>Topic <code>building/Main/100/water</code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
 "ts" : 1608570416309,
 "val" : 105.0
}</pre>
</div>
</div>
<div class="paragraph">
<p>Repeat water consumption data more than 5 times to see the report being
calculated and task assigned to technicians.</p>
</div>
<div class="paragraph">
<p>At any point in time you can use service API to see current
state of the active instances. For instance to get currently assigned
tasks for technicians for room 100 in building ABC issue following request</p>
</div>
<div class="paragraph">
<p><code><a href="http://localhost:8080/waterleaks/Main-100/tasks?group=technicians" class="bare">http://localhost:8080/waterleaks/Main-100/tasks?group=technicians</a></code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Why the format of the payload is as it is? The main reason is that it
follows <a href="https://github.com/mqtt-smarthome/mqtt-smarthome">MQTT SmartHome</a>
specification to provide some degree of standardisation.
</td>
</tr>
</table>
</div>
</div>
</details>
</div>
</div>
<div class="sect2">
<h3 id="_the_humidity_level_too_high_path"><a class="anchor" href="#_the_humidity_level_too_high_path"></a>The humidity level too high path</h3>
<div class="paragraph">
<p>The humidity level too high path means that at any time when humidity level is grater
than 85 it will assign another task for technicians. It is rather probable that there is
some kind of anomaly when humidity is too high.</p>
</div>
<div class="sect3">
<h4 id="_try_it_3"><a class="anchor" href="#_try_it_3"></a>Try it</h4>
<div class="paragraph">
<p>Follow steps in the <code>Details</code> section to see the humidity level too high path in action.</p>
</div>
<details>
<div class="content">
<div class="paragraph">
<p>Here are the steps to try out with humidity level too high path</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Publish room 100 of building Main humidity data</p>
<div class="ulist">
<ul>
<li>
<p>Topic <code>building/Main/100/humidity</code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "ts" : 1608570416309,
  "val" : 88.0
}</pre>
</div>
</div>
<div class="paragraph">
<p>This will create workflow instance and directly assign task for technicians.</p>
</div>
<div class="paragraph">
<p>At any point in time you can use service API to see current
state of the active instances. For instance to get currently assigned
tasks for technicians for room 100 in building ABC issue following request</p>
</div>
<div class="paragraph">
<p><code><a href="http://localhost:8080/waterleaks/Main-100/tasks?group=technicians" class="bare">http://localhost:8080/waterleaks/Main-100/tasks?group=technicians</a></code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Why the format of the payload is as it is? The main reason is that it
follows <a href="https://github.com/mqtt-smarthome/mqtt-smarthome">MQTT SmartHome</a>
specification to provide some degree of standardisation.
</td>
</tr>
</table>
</div>
</div>
</details>
</div>
</div>
<div class="sect2">
<h3 id="_the_publish_report_path"><a class="anchor" href="#_the_publish_report_path"></a>The publish report path</h3>
<div class="paragraph">
<p>Sensor data are collected for given amount of time. In this example they are set
to 1 hour. After one hour from first data received for given room and a building
report will be published to another MQTT topic.</p>
</div>
<div class="paragraph">
<p>The reports topic will be calculated based on the building and room it collects
data for. For example, workflow instance identified as (<code>ABC-123</code> which means
it collects data for room 123 in building ABC) will publish its report to
MQTT topic <code>reports/ABC/123/hourly</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In case you don&#8217;t want to wait for an hour to see the report being published
you can start the docker image with extra environment variable <code>-e WATER_LEAKS_TIMER=PT5M</code>
this will publish report after 5 minutes instead of 1 hour.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_try_it_4"><a class="anchor" href="#_try_it_4"></a>Try it</h4>
<div class="paragraph">
<p>Follow steps in the <code>Details</code> section to see the humidity level too high path in action.</p>
</div>
<details>
<div class="content">
<div class="paragraph">
<p>Here are the steps to try out with publish report path</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Publish room 100 of building Main humidity data</p>
<div class="ulist">
<ul>
<li>
<p>Topic <code>building/Main/100/humidity</code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "ts" : 1608570416309,
  "val" : 48.0
}</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Publish room 100 of building Main water data</p>
<div class="ulist">
<ul>
<li>
<p>Topic <code>building/Main/100/water</code></p>
</li>
<li>
<p>Payload</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "ts" : 1608570416309,
  "val" : 25.0
}</pre>
</div>
</div>
<div class="paragraph">
<p>Repeat water consumption data more than 5 times to see the report being
calculated. At any point in time you can use service API to see current
state of the active instances.</p>
</div>
<div class="paragraph">
<p>This will create workflow instance and directly assign task for technicians.</p>
</div>
<div class="paragraph">
<p>At any point in time you can use service API to see current
state of the active instances. For instance to get currently assigned
tasks for technicians for room 100 in building ABC issue following request</p>
</div>
<div class="paragraph">
<p><code><a href="http://localhost:8080/waterleaks/Main-100/tasks?group=technicians" class="bare">http://localhost:8080/waterleaks/Main-100/tasks?group=technicians</a></code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Why the format of the payload is as it is? The main reason is that it
follows <a href="https://github.com/mqtt-smarthome/mqtt-smarthome">MQTT SmartHome</a>
specification to provide some degree of standardisation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Another interesting aspect is that when report is published it will be consumed
but another workflow that is responsible for collecting data for entire building
based on published reports.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/water-consumption-report.png" alt="water consumption report">
</div>
</div>
</div>
</details>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_source_code"><a class="anchor" href="#_source_code"></a>Source code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Complete source code of this example can be found
<a href="https://github.com/automatiko-io/automatiko-examples/tree/main/event-streams-sensors">in GitHub</a></p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p class="text-center">© 2020 Automatiko. All rights reserved.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
